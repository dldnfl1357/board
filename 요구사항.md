# 요구사항 명세서

## 1. 기능 요구사항

### 1.1 회원 관리

#### 1.1.1 회원가입 (FR-USER-001)
- 사용자는 이메일, 비밀번호, 닉네임을 입력하여 회원가입을 할 수 있다
- 이메일은 고유해야 하며, 이메일 형식 검증이 필요하다
- 비밀번호는 최소 8자 이상, 영문/숫자/특수문자 조합이어야 한다
- 닉네임은 2-20자 이내, 고유해야 한다
- 가입 시 일반 사용자(USER) 권한으로 자동 설정된다
- 비밀번호는 암호화하여 저장해야 한다 (BCrypt)

#### 1.1.2 로그인 (FR-USER-002)
- 사용자는 이메일과 비밀번호로 로그인할 수 있다
- 로그인 성공 시 JWT 토큰을 발급받는다
- 로그인 실패 시 적절한 에러 메시지를 반환한다
- 5회 연속 로그인 실패 시 계정을 일시적으로 잠금 처리한다 (15분)

#### 1.1.3 회원 정보 조회/수정 (FR-USER-003)
- 사용자는 자신의 프로필 정보를 조회할 수 있다
- 사용자는 자신의 닉네임을 수정할 수 있다
- 사용자는 자신의 비밀번호를 변경할 수 있다 (기존 비밀번호 확인 필요)

#### 1.1.4 회원 탈퇴 (FR-USER-004)
- 사용자는 자신의 계정을 탈퇴할 수 있다
- 탈퇴 시 비밀번호 재확인이 필요하다
- 탈퇴한 회원의 게시글/댓글은 "탈퇴한 사용자"로 표시된다

### 1.2 권한 관리

#### 1.2.1 역할 구분 (FR-AUTH-001)
- 시스템은 ADMIN(관리자), USER(일반 사용자) 두 가지 역할을 지원한다
- ADMIN은 모든 기능에 접근할 수 있다
- USER는 제한된 기능만 사용할 수 있다

#### 1.2.2 관리자 권한 (FR-AUTH-002)
- 관리자는 카테고리를 생성/수정/삭제할 수 있다
- 관리자는 모든 게시글/댓글을 삭제할 수 있다
- 관리자는 사용자를 정지/해제할 수 있다

### 1.3 카테고리 관리

#### 1.3.1 카테고리 생성 (FR-CAT-001)
- 관리자는 카테고리를 생성할 수 있다
- 카테고리명은 2-50자 이내, 고유해야 한다
- 카테고리 설명을 추가할 수 있다 (선택, 최대 200자)
- 카테고리 표시 순서를 지정할 수 있다

#### 1.3.2 카테고리 수정 (FR-CAT-002)
- 관리자는 카테고리명, 설명, 표시 순서를 수정할 수 있다

#### 1.3.3 카테고리 삭제 (FR-CAT-003)
- 관리자는 카테고리를 삭제할 수 있다
- 카테고리 내 게시글이 있는 경우 삭제할 수 없다 (또는 다른 카테고리로 이동 필요)

#### 1.3.4 카테고리 조회 (FR-CAT-004)
- 모든 사용자는 카테고리 목록을 조회할 수 있다
- 카테고리별 게시글 개수를 확인할 수 있다

### 1.4 게시글 관리

#### 1.4.1 게시글 작성 (FR-POST-001)
- 로그인한 사용자는 게시글을 작성할 수 있다
- 제목 (2-200자), 내용 (1-10000자), 카테고리 선택이 필수다
- 작성 시 작성자, 작성일시가 자동으로 기록된다
- 첨부파일은 지원하지 않는다 (텍스트만)

#### 1.4.2 게시글 조회 (FR-POST-002)
- 모든 사용자는 게시글 목록을 조회할 수 있다
- 게시글 클릭 시 조회수가 1 증가한다
- 동일 사용자의 중복 조회수 증가를 방지한다 (24시간 기준)
- 게시글 상세 정보에는 제목, 내용, 작성자, 작성일시, 조회수, 좋아요/싫어요 수, 댓글 목록이 포함된다

#### 1.4.3 게시글 수정 (FR-POST-003)
- 게시글 작성자 또는 관리자만 수정할 수 있다
- 제목, 내용, 카테고리를 수정할 수 있다
- 수정 시 수정일시가 기록된다

#### 1.4.4 게시글 삭제 (FR-POST-004)
- 게시글 작성자 또는 관리자만 삭제할 수 있다
- 게시글 삭제 시 연관된 댓글, 좋아요/싫어요도 함께 삭제된다 (Cascade)
- 소프트 삭제 방식을 사용한다 (deletedAt 필드 활용)

#### 1.4.5 게시글 검색 (FR-POST-005)
- 제목, 내용, 작성자로 검색할 수 있다
- 카테고리별 필터링이 가능하다
- 작성일 범위로 필터링할 수 있다
- 검색 결과는 페이징 처리된다

#### 1.4.6 게시글 정렬 (FR-POST-006)
- 최신순, 조회수순, 좋아요순으로 정렬할 수 있다
- 기본 정렬은 최신순이다

### 1.5 댓글 관리

#### 1.5.1 댓글 작성 (FR-COMMENT-001)
- 로그인한 사용자는 게시글에 댓글을 작성할 수 있다
- 댓글 내용은 1-1000자 이내여야 한다
- 작성 시 작성자, 작성일시가 자동으로 기록된다

#### 1.5.2 대댓글 작성 (FR-COMMENT-002)
- 로그인한 사용자는 댓글에 대댓글을 작성할 수 있다
- 대댓글의 깊이는 제한이 없다 (무한 depth 지원)
- 부모 댓글이 삭제되어도 대댓글은 유지된다

#### 1.5.3 댓글 조회 (FR-COMMENT-003)
- 모든 사용자는 게시글의 댓글을 조회할 수 있다
- 댓글은 계층 구조로 표시된다
- 댓글 목록에는 작성자, 내용, 작성일시, 좋아요/싫어요 수가 포함된다

#### 1.5.4 댓글 수정 (FR-COMMENT-004)
- 댓글 작성자 또는 관리자만 수정할 수 있다
- 댓글 내용만 수정할 수 있다
- 수정 시 수정일시가 기록된다

#### 1.5.5 댓글 삭제 (FR-COMMENT-005)
- 댓글 작성자 또는 관리자만 삭제할 수 있다
- 대댓글이 있는 경우 "삭제된 댓글입니다"로 표시된다 (소프트 삭제)
- 대댓글이 없는 경우 완전히 삭제된다
- 댓글 삭제 시 연관된 좋아요/싫어요도 함께 삭제된다

### 1.6 좋아요/싫어요

#### 1.6.1 게시글 좋아요/싫어요 (FR-LIKE-001)
- 로그인한 사용자는 게시글에 좋아요 또는 싫어요를 누를 수 있다
- 한 사용자는 하나의 게시글에 좋아요 또는 싫어요 중 하나만 선택할 수 있다
- 이미 누른 상태에서 다시 누르면 취소된다
- 좋아요에서 싫어요로, 싫어요에서 좋아요로 변경 가능하다

#### 1.6.2 댓글 좋아요/싫어요 (FR-LIKE-002)
- 로그인한 사용자는 댓글에 좋아요 또는 싫어요를 누를 수 있다
- 게시글 좋아요/싫어요와 동일한 규칙이 적용된다

#### 1.6.3 좋아요/싫어요 조회 (FR-LIKE-003)
- 게시글/댓글의 총 좋아요 수와 싫어요 수를 조회할 수 있다
- 현재 사용자의 좋아요/싫어요 상태를 확인할 수 있다

### 1.7 페이징

#### 1.7.1 게시글 페이징 (FR-PAGE-001)
- 게시글 목록은 페이지 단위로 조회된다
- 페이지당 게시글 수는 10, 20, 50개 중 선택 가능하다 (기본 20개)
- 페이지 번호, 총 페이지 수, 총 게시글 수 정보를 제공한다

#### 1.7.2 댓글 페이징 (FR-PAGE-002)
- 댓글이 많을 경우 페이징 처리된다 (50개 단위)
- 최상위 댓글 기준으로 페이징하며, 대댓글은 모두 포함된다

## 2. 비기능 요구사항

### 2.1 성능 요구사항

#### 2.1.1 응답 시간 (NFR-PERF-001)
- 게시글 목록 조회: 평균 200ms 이하
- 게시글 상세 조회: 평균 300ms 이하
- 게시글 작성/수정: 평균 500ms 이하
- 검색 기능: 평균 500ms 이하

#### 2.1.2 동시 사용자 (NFR-PERF-002)
- 최소 1,000명의 동시 사용자를 처리할 수 있어야 한다
- Virtual Threads 활용으로 높은 동시성 지원

#### 2.1.3 처리량 (NFR-PERF-003)
- 초당 최소 1,000개의 읽기 요청을 처리할 수 있어야 한다
- 초당 최소 100개의 쓰기 요청을 처리할 수 있어야 한다

### 2.2 보안 요구사항

#### 2.2.1 인증/인가 (NFR-SEC-001)
- JWT 기반 Stateless 인증 방식 사용
- Access Token 유효기간: 1시간
- Refresh Token 유효기간: 7일
- 모든 민감한 정보는 암호화하여 저장

#### 2.2.2 입력 검증 (NFR-SEC-002)
- 모든 사용자 입력은 서버 측에서 검증되어야 한다
- XSS 공격 방어를 위한 입력 필터링
- SQL Injection 방어 (Prepared Statement, JPA 활용)

#### 2.2.3 권한 검증 (NFR-SEC-003)
- 모든 API 엔드포인트는 적절한 권한 검증을 수행해야 한다
- Method Security를 활용한 세밀한 권한 제어

### 2.3 가용성 요구사항

#### 2.3.1 시스템 가동률 (NFR-AVAIL-001)
- 시스템 가동률 99% 이상을 목표로 한다
- 장애 발생 시 자동 복구 메커니즘 구현

#### 2.3.2 에러 처리 (NFR-AVAIL-002)
- 모든 예외 상황에 대해 적절한 에러 메시지와 HTTP 상태 코드를 반환해야 한다
- 에러 발생 시 상세 로그를 기록해야 한다

### 2.4 확장성 요구사항

#### 2.4.1 수평 확장 (NFR-SCALE-001)
- Stateless 아키텍처로 수평 확장이 가능해야 한다
- 세션 정보는 외부 저장소(Redis)에 저장

#### 2.4.2 데이터베이스 확장 (NFR-SCALE-002)
- Read Replica를 통한 읽기 성능 향상 고려
- 인덱스 전략을 통한 쿼리 성능 최적화

### 2.5 유지보수성 요구사항

#### 2.5.1 코드 품질 (NFR-MAIN-001)
- 테스트 커버리지 80% 이상 유지
- SonarQube 기준 코드 품질 A등급 유지
- Javadoc 주석으로 API 문서화

#### 2.5.2 로깅 (NFR-MAIN-002)
- 모든 주요 비즈니스 로직에 적절한 로깅 적용
- 로그 레벨: TRACE, DEBUG, INFO, WARN, ERROR
- 구조화된 로깅 (JSON 형식)

#### 2.5.3 모니터링 (NFR-MAIN-003)
- Spring Actuator를 통한 헬스 체크
- 주요 메트릭 수집 (JVM, DB Connection Pool, API 응답시간 등)
- JFR을 활용한 프로파일링 가능

### 2.6 운영 요구사항

#### 2.6.1 환경 관리 (NFR-OPS-001)
- 개발(dev), 스테이징(staging), 운영(prod) 환경 분리
- Profile 기반 설정 관리

#### 2.6.2 배포 (NFR-OPS-002)
- 무중단 배포 지원
- 롤백 가능한 배포 전략

### 2.7 데이터 요구사항

#### 2.7.1 데이터 정합성 (NFR-DATA-001)
- ACID 트랜잭션 보장
- 낙관적/비관적 락을 통한 동시성 제어

#### 2.7.2 데이터 보관 (NFR-DATA-002)
- 삭제된 데이터는 30일간 보관 후 완전 삭제
- 감사 로그(Audit Log) 유지

## 3. 제약사항

### 3.1 기술 제약사항
- Java 21 LTS 사용
- Spring Boot 3.x 사용
- JPA/Hibernate ORM 사용
- 첨부파일 기능은 구현하지 않음 (텍스트 전용)

### 3.2 비즈니스 제약사항
- 게시판은 공개형으로 비회원도 조회 가능 (작성은 회원만)
- 관리자 계정은 초기 데이터로 생성됨
- 카테고리는 1단계만 지원 (하위 카테고리 없음)

## 4. 인터페이스 요구사항

### 4.1 외부 인터페이스
- RESTful API 제공
- JSON 형식의 요청/응답
- HTTP/HTTPS 프로토콜 사용

### 4.2 데이터베이스
- 관계형 데이터베이스(MySQL, PostgreSQL) 사용
- JPA를 통한 데이터 접근

### 4.3 캐시
- Redis를 활용한 분산 캐싱
- Ehcache를 활용한 로컬 캐싱 (2차 캐시)
